"use strict";var ur=Object.defineProperty;var tn=Object.getOwnPropertyDescriptor;var nn=Object.getOwnPropertyNames;var on=Object.prototype.hasOwnProperty;var an=(e,r)=>{for(var t in r)ur(e,t,{get:r[t],enumerable:!0})},sn=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of nn(r))!on.call(e,a)&&a!==t&&ur(e,a,{get:()=>r[a],enumerable:!(n=tn(r,a))||n.enumerable});return e};var ln=e=>sn(ur({},"__esModule",{value:!0}),e);var Va={};an(Va,{Feature:()=>V,OpaqueReference:()=>F,Serializer:()=>ve,SerovalDeserializationError:()=>Se,SerovalError:()=>ee,SerovalMissingInstanceError:()=>_,SerovalMissingPluginError:()=>U,SerovalMissingReferenceError:()=>ue,SerovalMissingReferenceForIdError:()=>ce,SerovalMode:()=>K,SerovalParserError:()=>O,SerovalSerializationError:()=>Ge,SerovalUnknownTypedArrayError:()=>pe,SerovalUnsupportedNodeError:()=>w,SerovalUnsupportedTypeError:()=>E,compileJSON:()=>Fa,createPlugin:()=>Fn,createReference:()=>at,createStream:()=>Y,crossSerialize:()=>Ea,crossSerializeAsync:()=>Pa,crossSerializeStream:()=>Zr,deserialize:()=>ka,fromCrossJSON:()=>ha,fromJSON:()=>Ba,getCrossReferenceHeader:()=>ot,resolvePlugins:()=>C,serialize:()=>wa,serializeAsync:()=>za,toCrossJSON:()=>xa,toCrossJSONAsync:()=>Ta,toCrossJSONStream:()=>Oa,toJSON:()=>_a,toJSONAsync:()=>Da});module.exports=ln(Va);var V=(s=>(s[s.AggregateError=1]="AggregateError",s[s.ArrowFunction=2]="ArrowFunction",s[s.ErrorPrototypeStack=4]="ErrorPrototypeStack",s[s.ObjectAssign=8]="ObjectAssign",s[s.BigIntTypedArray=16]="BigIntTypedArray",s))(V||{});var b=Symbol.asyncIterator,cr=Symbol.hasInstance,P=Symbol.isConcatSpreadable,A=Symbol.iterator,fr=Symbol.match,Sr=Symbol.matchAll,pr=Symbol.replace,dr=Symbol.search,mr=Symbol.species,gr=Symbol.split,yr=Symbol.toPrimitive,x=Symbol.toStringTag,Nr=Symbol.unscopables;var Hr={0:"Symbol.asyncIterator",1:"Symbol.hasInstance",2:"Symbol.isConcatSpreadable",3:"Symbol.iterator",4:"Symbol.match",5:"Symbol.matchAll",6:"Symbol.replace",7:"Symbol.search",8:"Symbol.species",9:"Symbol.split",10:"Symbol.toPrimitive",11:"Symbol.toStringTag",12:"Symbol.unscopables"},be={[b]:0,[cr]:1,[P]:2,[A]:3,[fr]:4,[Sr]:5,[pr]:6,[dr]:7,[mr]:8,[gr]:9,[yr]:10,[x]:11,[Nr]:12},$r={0:b,1:cr,2:P,3:A,4:fr,5:Sr,6:pr,7:dr,8:mr,9:gr,10:yr,11:x,12:Nr},qr={2:"!0",3:"!1",1:"void 0",0:"null",4:"-0",5:"1/0",6:"-1/0",7:"0/0"},Xr={2:!0,3:!1,1:void 0,0:null,4:-0,5:Number.POSITIVE_INFINITY,6:Number.NEGATIVE_INFINITY,7:Number.NaN};var Ae={0:"Error",1:"EvalError",2:"RangeError",3:"ReferenceError",4:"SyntaxError",5:"TypeError",6:"URIError"},Qr={0:Error,1:EvalError,2:RangeError,3:ReferenceError,4:SyntaxError,5:TypeError,6:URIError},o=void 0;function c(e,r,t,n,a,s,i,l,u,g,S,d){return{t:e,i:r,s:t,l:n,c:a,m:s,p:i,e:l,a:u,f:g,b:S,o:d}}function D(e){return c(2,o,e,o,o,o,o,o,o,o,o,o)}var $=D(2),q=D(3),Re=D(1),Ie=D(0),et=D(4),rt=D(5),tt=D(6),nt=D(7);function un(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"\f":return"\\f";case"<":return"\\x3C";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return}}function y(e){let r="",t=0,n;for(let a=0,s=e.length;a<s;a++)n=un(e[a]),n&&(r+=e.slice(t,a)+n,t=a+1);return t===0?r=e:r+=e.slice(t),r}function cn(e){switch(e){case"\\\\":return"\\";case'\\"':return'"';case"\\n":return`
`;case"\\r":return"\r";case"\\b":return"\b";case"\\t":return"	";case"\\f":return"\f";case"\\x3C":return"<";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029";default:return e}}function k(e){return e.replace(/(\\\\|\\"|\\n|\\r|\\b|\\t|\\f|\\u2028|\\u2029|\\x3C)/g,cn)}var M="__SEROVAL_REFS__",le="$R",Ee=`self.${le}`;function ot(e){return e==null?`${Ee}=${Ee}||[]`:`(${Ee}=${Ee}||{})["${y(e)}"]=[]`}var Cr=new Map,j=new Map;function at(e,r){return Cr.set(r,e),j.set(e,r),r}function vr(e){return Cr.has(e)}function fn(e){return j.has(e)}function st(e){if(vr(e))return Cr.get(e);throw new ue(e)}function it(e){if(fn(e))return j.get(e);throw new ce(e)}typeof globalThis!="undefined"?Object.defineProperty(globalThis,M,{value:j,configurable:!0,writable:!1,enumerable:!1}):typeof window!="undefined"?Object.defineProperty(window,M,{value:j,configurable:!0,writable:!1,enumerable:!1}):typeof self!="undefined"?Object.defineProperty(self,M,{value:j,configurable:!0,writable:!1,enumerable:!1}):typeof global!="undefined"&&Object.defineProperty(global,M,{value:j,configurable:!0,writable:!1,enumerable:!1});function Pe(e){return e instanceof EvalError?1:e instanceof RangeError?2:e instanceof ReferenceError?3:e instanceof SyntaxError?4:e instanceof TypeError?5:e instanceof URIError?6:0}function Sn(e){let r=Ae[Pe(e)];return e.name!==r?{name:e.name}:e.constructor.name!==r?{name:e.constructor.name}:{}}function X(e,r){let t=Sn(e),n=Object.getOwnPropertyNames(e);for(let a=0,s=n.length,i;a<s;a++)i=n[a],i!=="name"&&i!=="message"&&(i==="stack"?r&4&&(t=t||{},t[i]=e[i]):(t=t||{},t[i]=e[i]));return t}function xe(e){return Object.isFrozen(e)?3:Object.isSealed(e)?2:Object.isExtensible(e)?0:1}function Te(e){switch(e){case Number.POSITIVE_INFINITY:return rt;case Number.NEGATIVE_INFINITY:return tt}return e!==e?nt:Object.is(e,-0)?et:c(0,o,e,o,o,o,o,o,o,o,o,o)}function Q(e){return c(1,o,y(e),o,o,o,o,o,o,o,o,o)}function Oe(e){return c(3,o,""+e,o,o,o,o,o,o,o,o,o)}function ut(e){return c(4,e,o,o,o,o,o,o,o,o,o,o)}function he(e,r){let t=r.valueOf();return c(5,e,t!==t?"":r.toISOString(),o,o,o,o,o,o,o,o,o)}function we(e,r){return c(6,e,o,o,y(r.source),r.flags,o,o,o,o,o,o)}function ct(e,r){return c(17,e,be[r],o,o,o,o,o,o,o,o,o)}function ft(e,r){return c(18,e,y(st(r)),o,o,o,o,o,o,o,o,o)}function fe(e,r,t){return c(25,e,t,o,y(r),o,o,o,o,o,o,o)}function ze(e,r,t){return c(9,e,o,r.length,o,o,o,o,t,o,o,xe(r))}function ke(e,r){return c(21,e,o,o,o,o,o,o,o,r,o,o)}function _e(e,r,t){return c(15,e,o,r.length,r.constructor.name,o,o,o,o,t,r.byteOffset,o)}function De(e,r,t){return c(16,e,o,r.length,r.constructor.name,o,o,o,o,t,r.byteOffset,o)}function Fe(e,r,t){return c(20,e,o,r.byteLength,o,o,o,o,o,t,r.byteOffset,o)}function Be(e,r,t){return c(13,e,Pe(r),o,o,y(r.message),t,o,o,o,o,o)}function Ve(e,r,t){return c(14,e,Pe(r),o,o,y(r.message),t,o,o,o,o,o)}function Me(e,r,t){return c(7,e,o,r,o,o,o,o,t,o,o,o)}function je(e,r){return c(28,o,o,o,o,o,o,o,[e,r],o,o,o)}function Ue(e,r){return c(30,o,o,o,o,o,o,o,[e,r],o,o,o)}function Le(e,r,t){return c(31,e,o,o,o,o,o,o,t,r,o,o)}function Ye(e,r){return c(32,e,o,o,o,o,o,o,o,r,o,o)}function We(e,r){return c(33,e,o,o,o,o,o,o,o,r,o,o)}function Ke(e,r){return c(34,e,o,o,o,o,o,o,o,r,o,o)}var{toString:ys}=Object.prototype;var pn={parsing:1,serialization:2,deserialization:3};function dn(e){return`Seroval Error (step: ${pn[e]})`}var mn=(e,r)=>dn(e),ee=class extends Error{constructor(t,n){super(mn(t,n));this.cause=n}},O=class extends ee{constructor(r){super("parsing",r)}},Ge=class extends ee{constructor(r){super("serialization",r)}},Se=class extends ee{constructor(r){super("deserialization",r)}};function L(e){return`Seroval Error (specific: ${e})`}var E=class extends Error{constructor(t){super(L(1));this.value=t}},w=class extends Error{constructor(r){super(L(2))}},U=class extends Error{constructor(r){super(L(3))}},_=class extends Error{constructor(r){super(L(4))}},ue=class extends Error{constructor(t){super(L(5));this.value=t}},ce=class extends Error{constructor(r){super(L(6))}},pe=class extends Error{constructor(r){super(L(7))}};var F=class{constructor(r,t){this.value=r;this.replacement=t}};var re=()=>{let e={p:0,s:0,f:0};return e.p=new Promise((r,t)=>{e.s=r,e.f=t}),e},gn=(e,r)=>{e.s(r),e.p.s=1,e.p.v=r},yn=(e,r)=>{e.f(r),e.p.s=2,e.p.v=r},St=re.toString(),pt=gn.toString(),dt=yn.toString(),br=()=>{let e=[],r=[],t=!0,n=!1,a=0,s=(u,g,S)=>{for(S=0;S<a;S++)r[S]&&r[S][g](u)},i=(u,g,S,d)=>{for(g=0,S=e.length;g<S;g++)d=e[g],!t&&g===S-1?u[n?"return":"throw"](d):u.next(d)},l=(u,g)=>(t&&(g=a++,r[g]=u),i(u),()=>{t&&(r[g]=r[a],r[a--]=void 0)});return{__SEROVAL_STREAM__:!0,on:u=>l(u),next:u=>{t&&(e.push(u),s(u,"next"))},throw:u=>{t&&(e.push(u),s(u,"throw"),t=!1,n=!1,r.length=0)},return:u=>{t&&(e.push(u),s(u,"return"),t=!1,n=!0,r.length=0)}}},mt=br.toString(),Ar=e=>r=>()=>{let t=0,n={[e]:()=>n,next:()=>{if(t>r.d)return{done:!0,value:void 0};let a=t++,s=r.v[a];if(a===r.t)throw s;return{done:a===r.d,value:s}}};return n},gt=Ar.toString(),Rr=(e,r)=>t=>()=>{let n=0,a=-1,s=!1,i=[],l=[],u=(S=0,d=l.length)=>{for(;S<d;S++)l[S].s({done:!0,value:void 0})};t.on({next:S=>{let d=l.shift();d&&d.s({done:!1,value:S}),i.push(S)},throw:S=>{let d=l.shift();d&&d.f(S),u(),a=i.length,s=!0,i.push(S)},return:S=>{let d=l.shift();d&&d.s({done:!0,value:S}),u(),a=i.length,i.push(S)}});let g={[e]:()=>g,next:()=>{if(a===-1){let J=n++;if(J>=i.length){let Jr=r();return l.push(Jr),Jr.p}return{done:!1,value:i[J]}}if(n>a)return{done:!0,value:void 0};let S=n++,d=i[S];if(S!==a)return{done:!1,value:d};if(s)throw d;return{done:!0,value:d}}};return g},yt=Rr.toString(),Ir=(e,r)=>{let t=atob(r),n=new Uint8Array(e);for(let a=0;a<e;a++)n[a]=t.charCodeAt(a);return n.buffer},Nt=Ir.toString();var Ct={},vt={};var bt={0:{},1:{},2:{},3:{},4:{},5:{}},At={0:"[]",1:St,2:pt,3:dt,4:mt,5:Nt};function Ze(e){return"__SEROVAL_STREAM__"in e}function Y(){return br()}function Je(e){let r=Y(),t=e[b]();async function n(){try{let a=await t.next();a.done?r.return(a.value):(r.next(a.value),await n())}catch(a){r.throw(a)}}return n().catch(()=>{}),r}var Nn=Rr(b,re);function Rt(e){return Nn(e)}function He(e){let r=[],t=-1,n=-1,a=e[A]();for(;;)try{let s=a.next();if(r.push(s.value),s.done){n=r.length-1;break}}catch(s){t=r.length,r.push(s)}return{v:r,t,d:n}}var Cn=Ar(A);function It(e){return Cn(e)}async function Er(e){try{return[1,await e]}catch(r){return[0,r]}}function de(e,r){return{plugins:r.plugins,mode:e,marked:new Set,features:31^(r.disabledFeatures||0),refs:r.refs||new Map}}function me(e,r){e.marked.add(r)}function Pr(e,r){let t=e.refs.size;return e.refs.set(r,t),t}function $e(e,r){let t=e.refs.get(r);return t!=null?(me(e,t),{type:1,value:ut(t)}):{type:0,value:Pr(e,r)}}function W(e,r){let t=$e(e,r);return t.type===1?t:vr(r)?{type:2,value:ft(t.value,r)}:t}function I(e,r){let t=W(e,r);if(t.type!==0)return t.value;if(r in be)return ct(t.value,r);throw new E(r)}function z(e,r){let t=$e(e,bt[r]);return t.type===1?t.value:c(26,t.value,r,o,o,o,o,o,o,o,o,o)}function qe(e){let r=$e(e,Ct);return r.type===1?r.value:c(27,r.value,o,o,o,o,o,o,o,I(e,A),o,o)}function Xe(e){let r=$e(e,vt);return r.type===1?r.value:c(29,r.value,o,o,o,o,o,o,[z(e,1),I(e,b)],o,o,o)}function Qe(e,r,t,n){return c(t?11:10,e,o,o,o,o,n,o,o,o,o,xe(r))}function er(e,r,t,n,a){return c(8,r,o,o,o,o,o,{k:t,v:n,s:a},o,z(e,0),o,o)}function Pt(e,r,t){return c(22,r,t,o,o,o,o,o,o,z(e,1),o,o)}function rr(e,r,t){let n=new Uint8Array(t),a=n.length,s="";for(let i=0;i<a;i++)s+=String.fromCharCode(n[i]);return c(19,r,y(btoa(s)),a,o,o,o,o,o,z(e,5),o,o)}function te(e,r){return{base:de(e,r),child:void 0}}var Tr=class{constructor(r){this._p=r}parse(r){return N(this._p,r)}};async function An(e,r){let t=[];for(let n=0,a=r.length;n<a;n++)n in r&&(t[n]=await N(e,r[n]));return t}async function Rn(e,r,t){return ze(r,t,await An(e,t))}async function Or(e,r){let t=Object.entries(r),n=[],a=[];for(let s=0,i=t.length;s<i;s++)n.push(y(t[s][0])),a.push(await N(e,t[s][1]));return A in r&&(n.push(I(e.base,A)),a.push(je(qe(e.base),await N(e,He(r))))),b in r&&(n.push(I(e.base,b)),a.push(Ue(Xe(e.base),await N(e,Je(r))))),x in r&&(n.push(I(e.base,x)),a.push(Q(r[x]))),P in r&&(n.push(I(e.base,P)),a.push(r[P]?$:q)),{k:n,v:a,s:n.length}}async function xr(e,r,t,n){return Qe(r,t,n,await Or(e,t))}async function In(e,r,t){return ke(r,await N(e,t.valueOf()))}async function En(e,r,t){return _e(r,t,await N(e,t.buffer))}async function Pn(e,r,t){return De(r,t,await N(e,t.buffer))}async function xn(e,r,t){return Fe(r,t,await N(e,t.buffer))}async function xt(e,r,t){let n=X(t,e.base.features);return Be(r,t,n?await Or(e,n):o)}async function Tn(e,r,t){let n=X(t,e.base.features);return Ve(r,t,n?await Or(e,n):o)}async function On(e,r,t){let n=[],a=[];for(let[s,i]of t.entries())n.push(await N(e,s)),a.push(await N(e,i));return er(e.base,r,n,a,t.size)}async function hn(e,r,t){let n=[];for(let a of t.keys())n.push(await N(e,a));return Me(r,t.size,n)}async function Tt(e,r,t){let n=e.base.plugins;if(n)for(let a=0,s=n.length;a<s;a++){let i=n[a];if(i.parse.async&&i.test(t))return e.child==null&&(e.child=new Tr(e)),fe(r,i.tag,await i.parse.async(t,e.child,{id:r}))}return o}async function wn(e,r,t){let[n,a]=await Er(t);return c(12,r,n,o,o,o,o,o,o,await N(e,a),o,o)}function zn(e,r,t,n){let a=[],s=r.on({next:i=>{me(this.base,e),N(this,i).then(l=>{a.push(Ye(e,l))},l=>{n(l),s()})},throw:i=>{me(this.base,e),N(this,i).then(l=>{a.push(We(e,l)),t(a),s()},l=>{n(l),s()})},return:i=>{me(this.base,e),N(this,i).then(l=>{a.push(Ke(e,l)),t(a),s()},l=>{n(l),s()})}})}async function kn(e,r,t){return Le(r,z(e.base,4),await new Promise(zn.bind(e,r,t)))}async function _n(e,r,t){if(Array.isArray(t))return Rn(e,r,t);if(Ze(t))return kn(e,r,t);let n=t.constructor;if(n===F)return N(e,t.replacement);let a=await Tt(e,r,t);if(a)return a;switch(n){case Object:return xr(e,r,t,!1);case o:return xr(e,r,t,!0);case Date:return he(r,t);case RegExp:return we(r,t);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return xt(e,r,t);case Number:case Boolean:case String:case BigInt:return In(e,r,t);case ArrayBuffer:return rr(e.base,r,t);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return En(e,r,t);case DataView:return xn(e,r,t);case Map:return On(e,r,t);case Set:return hn(e,r,t);default:break}if(n===Promise||t instanceof Promise)return wn(e,r,t);let s=e.base.features;if(s&16)switch(n){case BigInt64Array:case BigUint64Array:return Pn(e,r,t);default:break}if(s&1&&typeof AggregateError!="undefined"&&(n===AggregateError||t instanceof AggregateError))return Tn(e,r,t);if(t instanceof Error)return xt(e,r,t);if(A in t||b in t)return xr(e,r,t,!!n);throw new E(t)}async function Dn(e,r){let t=W(e.base,r);if(t.type!==0)return t.value;let n=await Tt(e,t.value,r);if(n)return n;throw new E(r)}async function N(e,r){switch(typeof r){case"boolean":return r?$:q;case"undefined":return Re;case"string":return Q(r);case"number":return Te(r);case"bigint":return Oe(r);case"object":{if(r){let t=W(e.base,r);return t.type===0?await _n(e,t.value,r):t.value}return Ie}case"symbol":return I(e.base,r);case"function":return Dn(e,r);default:throw new E(r)}}async function ne(e,r){try{return await N(e,r)}catch(t){throw t instanceof O?t:new O(t)}}var K=(t=>(t[t.Vanilla=1]="Vanilla",t[t.Cross=2]="Cross",t))(K||{});function Fn(e){return e}function Ot(e,r){for(let t=0,n=r.length;t<n;t++){let a=r[t];e.has(a)||(e.add(a),a.extends&&Ot(e,a.extends))}}function C(e){if(e){let r=new Set;return Ot(r,e),[...r]}}function ht(e){switch(e){case"Int8Array":return Int8Array;case"Int16Array":return Int16Array;case"Int32Array":return Int32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":return Uint16Array;case"Uint32Array":return Uint32Array;case"Uint8ClampedArray":return Uint8ClampedArray;case"Float32Array":return Float32Array;case"Float64Array":return Float64Array;case"BigInt64Array":return BigInt64Array;case"BigUint64Array":return BigUint64Array;default:throw new pe(e)}}function wt(e,r){switch(r){case 3:return Object.freeze(e);case 1:return Object.preventExtensions(e);case 2:return Object.seal(e);default:return e}}function zt(e,r){return{mode:e,plugins:r.plugins,refs:r.refs||new Map}}function kt(e){return{mode:1,base:zt(1,e),child:void 0,state:{marked:new Set(e.markedRefs)}}}function _t(e){return{mode:2,base:zt(2,e),child:void 0}}var hr=class{constructor(r){this._p=r}deserialize(r){return m(this._p,r)}};function Bn(e,r,t){return e.state.marked.has(r)&&e.base.refs.set(r,t),t}function Vn(e,r,t){return e.base.refs.has(r)||e.base.refs.set(r,t),t}function v(e,r,t){return e.mode===1?Bn(e,r,t):Vn(e,r,t)}function Mn(e,r){return v(e,r.i,it(k(r.s)))}function jn(e,r){let t=r.l,n=v(e,r.i,new Array(t)),a;for(let s=0;s<t;s++)a=r.a[s],a&&(n[s]=m(e,a));return wt(n,r.o),n}function Dt(e,r,t){let n=r.s;if(n){let a=r.k,s=r.v;for(let i=0,l;i<n;i++)l=a[i],typeof l=="string"?t[k(l)]=m(e,s[i]):t[m(e,l)]=m(e,s[i])}return t}function Un(e,r){let t=v(e,r.i,r.t===10?{}:Object.create(null));return Dt(e,r.p,t),wt(t,r.o),t}function Ln(e,r){return v(e,r.i,new Date(r.s))}function Yn(e,r){return v(e,r.i,new RegExp(k(r.c),r.m))}function Wn(e,r){let t=v(e,r.i,new Set),n=r.a;for(let a=0,s=r.l;a<s;a++)t.add(m(e,n[a]));return t}function Kn(e,r){let t=v(e,r.i,new Map),n=r.e.k,a=r.e.v;for(let s=0,i=r.e.s;s<i;s++)t.set(m(e,n[s]),m(e,a[s]));return t}function Gn(e,r){return v(e,r.i,Ir(r.l,k(r.s)))}function Zn(e,r){let t=ht(r.c),n=m(e,r.f);return v(e,r.i,new t(n,r.b,r.l))}function Jn(e,r){let t=m(e,r.f);return v(e,r.i,new DataView(t,r.b,r.l))}function Ft(e,r,t){if(r.p){let n=Dt(e,r.p,{});Object.assign(t,n)}return t}function Hn(e,r){let t=v(e,r.i,new AggregateError([],k(r.m)));return Ft(e,r,t)}function $n(e,r){let t=Qr[r.s],n=v(e,r.i,new t(k(r.m)));return Ft(e,r,n)}function qn(e,r){let t=re(),n=v(e,r.i,t.p),a=m(e,r.f);return r.s?t.s(a):t.f(a),n}function Xn(e,r){return v(e,r.i,Object(m(e,r.f)))}function Qn(e,r){let t=e.base.plugins;if(t){let n=k(r.c);for(let a=0,s=t.length;a<s;a++){let i=t[a];if(i.tag===n)return e.child==null&&(e.child=new hr(e)),v(e,r.i,i.deserialize(r.s,e.child,{id:r.i}))}}throw new U(r.c)}function eo(e,r){return v(e,r.i,v(e,r.s,re()).p)}function ro(e,r){let t=e.base.refs.get(r.i);if(t){t.s(m(e,r.a[1]));return}throw new _("Promise")}function to(e,r){let t=e.base.refs.get(r.i);if(t){t.f(m(e,r.a[1]));return}throw new _("Promise")}function no(e,r){m(e,r.a[0]);let t=m(e,r.a[1]);return It(t)}function oo(e,r){m(e,r.a[0]);let t=m(e,r.a[1]);return Rt(t)}function ao(e,r){let t=v(e,r.i,Y()),n=r.a.length;if(n)for(let a=0;a<n;a++)m(e,r.a[a]);return t}function so(e,r){let t=e.base.refs.get(r.i);if(t){t.next(m(e,r.f));return}throw new _("Stream")}function io(e,r){let t=e.base.refs.get(r.i);if(t){t.throw(m(e,r.f));return}throw new _("Stream")}function lo(e,r){let t=e.base.refs.get(r.i);if(t){t.return(m(e,r.f));return}throw new _("Stream")}function uo(e,r){m(e,r.f)}function co(e,r){m(e,r.a[1])}function m(e,r){switch(r.t){case 2:return Xr[r.s];case 0:return r.s;case 1:return k(r.s);case 3:return BigInt(r.s);case 4:return e.base.refs.get(r.i);case 18:return Mn(e,r);case 9:return jn(e,r);case 10:case 11:return Un(e,r);case 5:return Ln(e,r);case 6:return Yn(e,r);case 7:return Wn(e,r);case 8:return Kn(e,r);case 19:return Gn(e,r);case 16:case 15:return Zn(e,r);case 20:return Jn(e,r);case 14:return Hn(e,r);case 13:return $n(e,r);case 12:return qn(e,r);case 17:return $r[r.s];case 21:return Xn(e,r);case 25:return Qn(e,r);case 22:return eo(e,r);case 23:return ro(e,r);case 24:return to(e,r);case 28:return no(e,r);case 30:return oo(e,r);case 31:return ao(e,r);case 32:return so(e,r);case 33:return io(e,r);case 34:return lo(e,r);case 27:return uo(e,r);case 29:return co(e,r);default:throw new w(r)}}function tr(e,r){try{return m(e,r)}catch(t){throw new Se(t)}}var fo=()=>T,So=fo.toString(),Bt=/=>/.test(So);function nr(e,r){return Bt?(e.length===1?e[0]:"("+e.join(",")+")")+"=>"+(r.startsWith("{")?"("+r+")":r):"function("+e.join(",")+"){return "+r+"}"}function Vt(e,r){return Bt?(e.length===1?e[0]:"("+e.join(",")+")")+"=>{"+r+"}":"function("+e.join(",")+"){"+r+"}"}var Ut="hjkmoquxzABCDEFGHIJKLNPQRTUVWXYZ$_",Mt=Ut.length,Lt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$_",jt=Lt.length;function wr(e){let r=e%Mt,t=Ut[r];for(e=(e-r)/Mt;e>0;)r=e%jt,t+=Lt[r],e=(e-r)/jt;return t}var po=/^[$A-Z_][0-9A-Z_$]*$/i;function zr(e){let r=e[0];return(r==="$"||r==="_"||r>="A"&&r<="Z"||r>="a"&&r<="z")&&po.test(e)}function ye(e){switch(e.t){case 0:return e.s+"="+e.v;case 2:return e.s+".set("+e.k+","+e.v+")";case 1:return e.s+".add("+e.v+")";case 3:return e.s+".delete("+e.k+")"}}function mo(e){let r=[],t=e[0];for(let n=1,a=e.length,s,i=t;n<a;n++)s=e[n],s.t===0&&s.v===i.v?t={t:0,s:s.s,k:o,v:ye(t)}:s.t===2&&s.s===i.s?t={t:2,s:ye(t),k:s.k,v:s.v}:s.t===1&&s.s===i.s?t={t:1,s:ye(t),k:o,v:s.v}:s.t===3&&s.s===i.s?t={t:3,s:ye(t),k:s.k,v:o}:(r.push(t),t=s),i=s;return r.push(t),r}function Jt(e){if(e.length){let r="",t=mo(e);for(let n=0,a=t.length;n<a;n++)r+=ye(t[n])+",";return r}return o}var go="Object.create(null)",yo="new Set",No="new Map",Co="Promise.resolve",vo="Promise.reject",bo={3:"Object.freeze",2:"Object.seal",1:"Object.preventExtensions",0:o};function Ht(e,r){return{mode:e,plugins:r.plugins,features:r.features,marked:new Set(r.markedRefs),stack:[],flags:[],assignments:[]}}function Ao(){return{valid:new Map,vars:[]}}function or(e){return{mode:1,base:Ht(1,e),state:Ao(),child:void 0}}function ar(e){return{mode:2,base:Ht(2,e),state:e,child:void 0}}var kr=class{constructor(r){this._p=r}serialize(r){return f(this._p,r)}};function Ro(e,r){let t=e.valid.get(r);t==null&&(t=e.valid.size,e.valid.set(r,t));let n=e.vars[t];return n==null&&(n=wr(t),e.vars[t]=n),n}function Io(e){return le+"["+e+"]"}function p(e,r){return e.mode===1?Ro(e.state,r):Io(r)}function h(e,r){e.marked.add(r)}function _r(e,r){return e.marked.has(r)}function Fr(e,r,t){r!==0&&(h(e.base,t),e.base.flags.push({type:r,value:p(e,t)}))}function Eo(e){let r="";for(let t=0,n=e.flags,a=n.length;t<a;t++){let s=n[t];r+=bo[s.type]+"("+s.value+"),"}return r}function $t(e){let r=Jt(e.assignments),t=Eo(e);return r?t?r+t:r:t}function qt(e,r,t){e.assignments.push({t:0,s:r,k:o,v:t})}function Po(e,r,t){e.base.assignments.push({t:1,s:p(e,r),k:o,v:t})}function ge(e,r,t,n){e.base.assignments.push({t:2,s:p(e,r),k:t,v:n})}function Yt(e,r,t){e.base.assignments.push({t:3,s:p(e,r),k:t,v:o})}function Ne(e,r,t,n){qt(e.base,p(e,r)+"["+t+"]",n)}function Dr(e,r,t,n){qt(e.base,p(e,r)+"."+t,n)}function B(e,r){return r.t===4&&e.stack.includes(r.i)}function oe(e,r,t){return e.mode===1&&!_r(e.base,r)?t:p(e,r)+"="+t}function xo(e){return M+'.get("'+e.s+'")'}function Wt(e,r,t,n){return t?B(e.base,t)?(h(e.base,r),Ne(e,r,n,p(e,t.i)),""):f(e,t):""}function To(e,r){let t=r.i;if(r.l){e.base.stack.push(t);let n=r.a,a=Wt(e,t,n[0],0),s=a==="";for(let i=1,l=r.l,u;i<l;i++)u=Wt(e,t,n[i],i),a+=","+u,s=u==="";return e.base.stack.pop(),Fr(e,r.o,r.i),"["+a+(s?",]":"]")}return"[]"}function Kt(e,r,t,n){if(typeof t=="string"){let a=Number(t),s=a>=0&&a.toString()===t||zr(t);if(B(e.base,n)){let i=p(e,n.i);return h(e.base,r.i),s&&a!==a?Dr(e,r.i,t,i):Ne(e,r.i,s?t:'"'+t+'"',i),""}return(s?t:'"'+t+'"')+":"+f(e,n)}return"["+f(e,t)+"]:"+f(e,n)}function Xt(e,r,t){let n=t.s;if(n){let a=t.k,s=t.v;e.base.stack.push(r.i);let i=Kt(e,r,a[0],s[0]);for(let l=1,u=i;l<n;l++)u=Kt(e,r,a[l],s[l]),i+=(u&&i&&",")+u;return e.base.stack.pop(),"{"+i+"}"}return"{}"}function Oo(e,r){return Fr(e,r.o,r.i),Xt(e,r,r.p)}function ho(e,r,t,n){let a=Xt(e,r,t);return a!=="{}"?"Object.assign("+n+","+a+")":n}function wo(e,r,t,n,a){let s=e.base,i=f(e,a),l=Number(n),u=l>=0&&l.toString()===n||zr(n);if(B(s,a))u&&l!==l?Dr(e,r.i,n,i):Ne(e,r.i,u?n:'"'+n+'"',i);else{let g=s.assignments;s.assignments=t,u&&l!==l?Dr(e,r.i,n,i):Ne(e,r.i,u?n:'"'+n+'"',i),s.assignments=g}}function zo(e,r,t,n,a){if(typeof n=="string")wo(e,r,t,n,a);else{let s=e.base,i=s.stack;s.stack=[];let l=f(e,a);s.stack=i;let u=s.assignments;s.assignments=t,Ne(e,r.i,f(e,n),l),s.assignments=u}}function ko(e,r,t){let n=t.s;if(n){let a=[],s=t.k,i=t.v;e.base.stack.push(r.i);for(let l=0;l<n;l++)zo(e,r,a,s[l],i[l]);return e.base.stack.pop(),Jt(a)}return o}function Br(e,r,t){if(r.p){let n=e.base;if(n.features&8)t=ho(e,r,r.p,t);else{h(n,r.i);let a=ko(e,r,r.p);if(a)return"("+oe(e,r.i,t)+","+a+p(e,r.i)+")"}}return t}function _o(e,r){return Fr(e,r.o,r.i),Br(e,r,go)}function Do(e){return'new Date("'+e.s+'")'}function Fo(e){return"/"+e.c+"/"+e.m}function Gt(e,r,t){let n=e.base;return B(n,t)?(h(n,r),Po(e,r,p(e,t.i)),""):f(e,t)}function Bo(e,r){let t=yo,n=r.l,a=r.i;if(n){let s=r.a;e.base.stack.push(a);let i=Gt(e,a,s[0]);for(let l=1,u=i;l<n;l++)u=Gt(e,a,s[l]),i+=(u&&i&&",")+u;e.base.stack.pop(),i&&(t+="(["+i+"])")}return t}function Zt(e,r,t,n,a){let s=e.base;if(B(s,t)){let i=p(e,t.i);if(h(s,r),B(s,n)){let u=p(e,n.i);return ge(e,r,i,u),""}if(n.t!==4&&n.i!=null&&_r(s,n.i)){let u="("+f(e,n)+",["+a+","+a+"])";return ge(e,r,i,p(e,n.i)),Yt(e,r,a),u}let l=s.stack;return s.stack=[],ge(e,r,i,f(e,n)),s.stack=l,""}if(B(s,n)){let i=p(e,n.i);if(h(s,r),t.t!==4&&t.i!=null&&_r(s,t.i)){let u="("+f(e,t)+",["+a+","+a+"])";return ge(e,r,p(e,t.i),i),Yt(e,r,a),u}let l=s.stack;return s.stack=[],ge(e,r,f(e,t),i),s.stack=l,""}return"["+f(e,t)+","+f(e,n)+"]"}function Vo(e,r){let t=No,n=r.e.s,a=r.i,s=r.f,i=p(e,s.i),l=e.base;if(n){let u=r.e.k,g=r.e.v;l.stack.push(a);let S=Zt(e,a,u[0],g[0],i);for(let d=1,J=S;d<n;d++)J=Zt(e,a,u[d],g[d],i),S+=(J&&S&&",")+J;l.stack.pop(),S&&(t+="(["+S+"])")}return s.t===26&&(h(l,s.i),t="("+f(e,s)+","+t+")"),t}function Mo(e,r){return G(e,r.f)+"("+r.l+',"'+r.s+'")'}function jo(e,r){return"new "+r.c+"("+f(e,r.f)+","+r.b+","+r.l+")"}function Uo(e,r){return"new DataView("+f(e,r.f)+","+r.b+","+r.l+")"}function Lo(e,r){let t=r.i;e.base.stack.push(t);let n=Br(e,r,'new AggregateError([],"'+r.m+'")');return e.base.stack.pop(),n}function Yo(e,r){return Br(e,r,"new "+Ae[r.s]+'("'+r.m+'")')}function Wo(e,r){let t,n=r.f,a=r.i,s=r.s?Co:vo,i=e.base;if(B(i,n)){let l=p(e,n.i);t=s+(r.s?"().then("+nr([],l)+")":"().catch("+Vt([],"throw "+l)+")")}else{i.stack.push(a);let l=f(e,n);i.stack.pop(),t=s+"("+l+")"}return t}function Ko(e,r){return"Object("+f(e,r.f)+")"}function G(e,r){let t=f(e,r);return r.t===4?t:"("+t+")"}function Go(e,r){if(e.mode===1)throw new w(r);return"("+oe(e,r.s,G(e,r.f)+"()")+").p"}function Zo(e,r){if(e.mode===1)throw new w(r);return G(e,r.a[0])+"("+p(e,r.i)+","+f(e,r.a[1])+")"}function Jo(e,r){if(e.mode===1)throw new w(r);return G(e,r.a[0])+"("+p(e,r.i)+","+f(e,r.a[1])+")"}function Ho(e,r){let t=e.base.plugins;if(t)for(let n=0,a=t.length;n<a;n++){let s=t[n];if(s.tag===r.c)return e.child==null&&(e.child=new kr(e)),s.serialize(r.s,e.child,{id:r.i})}throw new U(r.c)}function $o(e,r){let t="",n=!1;return r.f.t!==4&&(h(e.base,r.f.i),t="("+f(e,r.f)+",",n=!0),t+=oe(e,r.i,"("+gt+")("+p(e,r.f.i)+")"),n&&(t+=")"),t}function qo(e,r){return G(e,r.a[0])+"("+f(e,r.a[1])+")"}function Xo(e,r){let t=r.a[0],n=r.a[1],a=e.base,s="";t.t!==4&&(h(a,t.i),s+="("+f(e,t)),n.t!==4&&(h(a,n.i),s+=(s?",":"(")+f(e,n)),s&&(s+=",");let i=oe(e,r.i,"("+yt+")("+p(e,n.i)+","+p(e,t.i)+")");return s?s+i+")":i}function Qo(e,r){return G(e,r.a[0])+"("+f(e,r.a[1])+")"}function ea(e,r){let t=oe(e,r.i,G(e,r.f)+"()"),n=r.a.length;if(n){let a=f(e,r.a[0]);for(let s=1;s<n;s++)a+=","+f(e,r.a[s]);return"("+t+","+a+","+p(e,r.i)+")"}return t}function ra(e,r){return p(e,r.i)+".next("+f(e,r.f)+")"}function ta(e,r){return p(e,r.i)+".throw("+f(e,r.f)+")"}function na(e,r){return p(e,r.i)+".return("+f(e,r.f)+")"}function oa(e,r){switch(r.t){case 17:return Hr[r.s];case 18:return xo(r);case 9:return To(e,r);case 10:return Oo(e,r);case 11:return _o(e,r);case 5:return Do(r);case 6:return Fo(r);case 7:return Bo(e,r);case 8:return Vo(e,r);case 19:return Mo(e,r);case 16:case 15:return jo(e,r);case 20:return Uo(e,r);case 14:return Lo(e,r);case 13:return Yo(e,r);case 12:return Wo(e,r);case 21:return Ko(e,r);case 22:return Go(e,r);case 25:return Ho(e,r);case 26:return At[r.s];default:throw new w(r)}}function f(e,r){switch(r.t){case 2:return qr[r.s];case 0:return""+r.s;case 1:return'"'+r.s+'"';case 3:return r.s+"n";case 4:return p(e,r.i);case 23:return Zo(e,r);case 24:return Jo(e,r);case 27:return $o(e,r);case 28:return qo(e,r);case 29:return Xo(e,r);case 30:return Qo(e,r);case 31:return ea(e,r);case 32:return ra(e,r);case 33:return ta(e,r);case 34:return na(e,r);default:return oe(e,r.i,oa(e,r))}}function sr(e,r){let t=f(e,r);if(r.i!=null&&e.state.vars.length){let n=$t(e.base),a=t;if(n){let s=p(e,r.i);a=t+","+n+s,t.startsWith(s+"=")||(a=s+"="+a),a="("+a+")"}return"("+nr(e.state.vars,a)+")()"}return r.t===10?"("+t+")":t}function ir(e,r){let t=f(e,r),n=r.i;if(n==null)return t;let a=$t(e.base),s=p(e,n),i=e.state.scopeId,l=i==null?"":le,u=a?"("+t+","+a+s+")":t;if(l==="")return r.t===10&&!a?"("+u+")":u;let g=i==null?"()":"("+le+'["'+y(i)+'"])';return"("+nr([l],u)+")"+g}function se(e,r){return{type:1,base:de(e,r),child:void 0}}var Mr=class{constructor(r){this._p=r}parse(r){return R(this._p,r)}},jr=class{constructor(r){this._p=r}parse(r){return R(this._p,r)}parseWithError(r){return Z(this._p,r)}isAlive(){return this._p.state.alive}pushPendingState(){Kr(this._p)}popPendingState(){Ce(this._p)}onParse(r){ae(this._p,r)}onError(r){Yr(this._p,r)}};function aa(e){return{alive:!0,pending:0,initial:!0,buffer:[],onParse:e.onParse,onError:e.onError,onDone:e.onDone}}function Ur(e){return{type:2,base:de(2,e),child:void 0,state:aa(e)}}function sa(e,r){let t=[];for(let n=0,a=r.length;n<a;n++)n in r&&(t[n]=R(e,r[n]));return t}function ia(e,r,t){return ze(r,t,sa(e,t))}function Lr(e,r){let t=Object.entries(r),n=[],a=[];for(let s=0,i=t.length;s<i;s++)n.push(y(t[s][0])),a.push(R(e,t[s][1]));return A in r&&(n.push(I(e.base,A)),a.push(je(qe(e.base),R(e,He(r))))),b in r&&(n.push(I(e.base,b)),a.push(Ue(Xe(e.base),R(e,e.type===1?Y():Je(r))))),x in r&&(n.push(I(e.base,x)),a.push(Q(r[x]))),P in r&&(n.push(I(e.base,P)),a.push(r[P]?$:q)),{k:n,v:a,s:n.length}}function Vr(e,r,t,n){return Qe(r,t,n,Lr(e,t))}function la(e,r,t){return ke(r,R(e,t.valueOf()))}function ua(e,r,t){return _e(r,t,R(e,t.buffer))}function ca(e,r,t){return De(r,t,R(e,t.buffer))}function fa(e,r,t){return Fe(r,t,R(e,t.buffer))}function Qt(e,r,t){let n=X(t,e.base.features);return Be(r,t,n?Lr(e,n):o)}function Sa(e,r,t){let n=X(t,e.base.features);return Ve(r,t,n?Lr(e,n):o)}function pa(e,r,t){let n=[],a=[];for(let[s,i]of t.entries())n.push(R(e,s)),a.push(R(e,i));return er(e.base,r,n,a,t.size)}function da(e,r,t){let n=[];for(let a of t.keys())n.push(R(e,a));return Me(r,t.size,n)}function ma(e,r,t){let n=Le(r,z(e.base,4),[]);return e.type===1||(Kr(e),t.on({next:a=>{if(e.state.alive){let s=Z(e,a);s&&ae(e,Ye(r,s))}},throw:a=>{if(e.state.alive){let s=Z(e,a);s&&ae(e,We(r,s))}Ce(e)},return:a=>{if(e.state.alive){let s=Z(e,a);s&&ae(e,Ke(r,s))}Ce(e)}})),n}function ga(e,r){if(this.state.alive){let t=Z(this,r);t&&ae(this,c(23,e,o,o,o,o,o,o,[z(this.base,2),t],o,o,o)),Ce(this)}}function ya(e,r){if(this.state.alive){let t=Z(this,r);t&&ae(this,c(24,e,o,o,o,o,o,o,[z(this.base,3),t],o,o,o))}Ce(this)}function Na(e,r,t){let n=Pr(e.base,{});return e.type===2&&(Kr(e),t.then(ga.bind(e,n),ya.bind(e,n))),Pt(e.base,r,n)}function Ca(e,r,t,n){for(let a=0,s=n.length;a<s;a++){let i=n[a];if(i.parse.sync&&i.test(t))return e.child==null&&(e.child=new Mr(e)),fe(r,i.tag,i.parse.sync(t,e.child,{id:r}))}}function va(e,r,t,n){for(let a=0,s=n.length;a<s;a++){let i=n[a];if(i.parse.stream&&i.test(t))return e.child==null&&(e.child=new jr(e)),fe(r,i.tag,i.parse.stream(t,e.child,{id:r}))}}function en(e,r,t){let n=e.base.plugins;if(n)return e.type===1?Ca(e,r,t,n):va(e,r,t,n)}function ba(e,r,t,n){switch(n){case Object:return Vr(e,r,t,!1);case void 0:return Vr(e,r,t,!0);case Date:return he(r,t);case RegExp:return we(r,t);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return Qt(e,r,t);case Number:case Boolean:case String:case BigInt:return la(e,r,t);case ArrayBuffer:return rr(e.base,r,t);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return ua(e,r,t);case DataView:return fa(e,r,t);case Map:return pa(e,r,t);case Set:return da(e,r,t);default:break}if(n===Promise||t instanceof Promise)return Na(e,r,t);let a=e.base.features;if(a&16)switch(n){case BigInt64Array:case BigUint64Array:return ca(e,r,t);default:break}if(a&1&&typeof AggregateError!="undefined"&&(n===AggregateError||t instanceof AggregateError))return Sa(e,r,t);if(t instanceof Error)return Qt(e,r,t);if(A in t||b in t)return Vr(e,r,t,!!n);throw new E(t)}function Aa(e,r,t){if(Array.isArray(t))return ia(e,r,t);if(Ze(t))return ma(e,r,t);let n=t.constructor;if(n===F)return R(e,t.replacement);let a=en(e,r,t);return a||ba(e,r,t,n)}function Ra(e,r){let t=W(e.base,r);if(t.type!==0)return t.value;let n=en(e,t.value,r);if(n)return n;throw new E(r)}function R(e,r){switch(typeof r){case"boolean":return r?$:q;case"undefined":return Re;case"string":return Q(r);case"number":return Te(r);case"bigint":return Oe(r);case"object":{if(r){let t=W(e.base,r);return t.type===0?Aa(e,t.value,r):t.value}return Ie}case"symbol":return I(e.base,r);case"function":return Ra(e,r);default:throw new E(r)}}function ie(e,r){try{return R(e,r)}catch(t){throw t instanceof O?t:new O(t)}}function ae(e,r){e.state.initial?e.state.buffer.push(r):Wr(e,r,!1)}function Yr(e,r){if(e.state.onError)e.state.onError(r);else throw r instanceof O?r:new O(r)}function rn(e){e.state.onDone&&e.state.onDone()}function Wr(e,r,t){try{e.state.onParse(r,t)}catch(n){Yr(e,n)}}function Kr(e){e.state.pending++}function Ce(e){--e.state.pending<=0&&rn(e)}function Z(e,r){try{return R(e,r)}catch(t){return Yr(e,t),o}}function Gr(e,r){let t=Z(e,r);t&&(Wr(e,t,!0),e.state.initial=!1,Ia(e,e.state),e.state.pending<=0&&lr(e))}function Ia(e,r){for(let t=0,n=r.buffer.length;t<n;t++)Wr(e,r.buffer[t],!1)}function lr(e){e.state.alive&&(rn(e),e.state.alive=!1)}function Ea(e,r={}){let t=C(r.plugins),n=se(2,{plugins:t,disabledFeatures:r.disabledFeatures,refs:r.refs}),a=ie(n,e),s=ar({plugins:t,features:n.base.features,scopeId:r.scopeId,markedRefs:n.base.marked});return ir(s,a)}async function Pa(e,r={}){let t=C(r.plugins),n=te(2,{plugins:t,disabledFeatures:r.disabledFeatures,refs:r.refs}),a=await ne(n,e),s=ar({plugins:t,features:n.base.features,scopeId:r.scopeId,markedRefs:n.base.marked});return ir(s,a)}function xa(e,r={}){let t=C(r.plugins),n=se(2,{plugins:t,disabledFeatures:r.disabledFeatures,refs:r.refs});return ie(n,e)}async function Ta(e,r={}){let t=C(r.plugins),n=te(2,{plugins:t,disabledFeatures:r.disabledFeatures,refs:r.refs});return await ne(n,e)}function Zr(e,r){let t=C(r.plugins),n=Ur({plugins:t,refs:r.refs,disabledFeatures:r.disabledFeatures,onParse(a,s){let i=ar({plugins:t,features:n.base.features,scopeId:r.scopeId,markedRefs:n.base.marked}),l;try{l=ir(i,a)}catch(u){r.onError&&r.onError(u);return}r.onSerialize(l,s)},onError:r.onError,onDone:r.onDone});return Gr(n,e),lr.bind(null,n)}function Oa(e,r){let t=C(r.plugins),n=Ur({plugins:t,refs:r.refs,disabledFeatures:r.disabledFeatures,onParse:r.onParse,onError:r.onError,onDone:r.onDone});return Gr(n,e),lr.bind(null,n)}function ha(e,r){let t=C(r.plugins),n=_t({plugins:t,refs:r.refs});return tr(n,e)}var ve=class{constructor(r){this.options=r;this.alive=!0;this.flushed=!1;this.done=!1;this.pending=0;this.cleanups=[];this.refs=new Map;this.keys=new Set;this.ids=0;this.plugins=C(r.plugins)}write(r,t){this.alive&&!this.flushed&&(this.pending++,this.keys.add(r),this.cleanups.push(Zr(t,{plugins:this.plugins,scopeId:this.options.scopeId,refs:this.refs,disabledFeatures:this.options.disabledFeatures,onError:this.options.onError,onSerialize:(n,a)=>{this.alive&&this.options.onData(a?this.options.globalIdentifier+'["'+y(r)+'"]='+n:n)},onDone:()=>{this.alive&&(this.pending--,this.pending<=0&&this.flushed&&!this.done&&this.options.onDone&&(this.options.onDone(),this.done=!0))}})))}getNextID(){for(;this.keys.has(""+this.ids);)this.ids++;return""+this.ids}push(r){let t=this.getNextID();return this.write(t,r),t}flush(){this.alive&&(this.flushed=!0,this.pending<=0&&!this.done&&this.options.onDone&&(this.options.onDone(),this.done=!0))}close(){if(this.alive){for(let r=0,t=this.cleanups.length;r<t;r++)this.cleanups[r]();!this.done&&this.options.onDone&&(this.options.onDone(),this.done=!0),this.alive=!1}}};function wa(e,r={}){let t=C(r.plugins),n=se(1,{plugins:t,disabledFeatures:r.disabledFeatures}),a=ie(n,e),s=or({plugins:t,features:n.base.features,markedRefs:n.base.marked});return sr(s,a)}async function za(e,r={}){let t=C(r.plugins),n=te(1,{plugins:t,disabledFeatures:r.disabledFeatures}),a=await ne(n,e),s=or({plugins:t,features:n.base.features,markedRefs:n.base.marked});return sr(s,a)}function ka(e){return(0,eval)(e)}function _a(e,r={}){let t=C(r.plugins),n=se(1,{plugins:t,disabledFeatures:r.disabledFeatures});return{t:ie(n,e),f:n.base.features,m:Array.from(n.base.marked)}}async function Da(e,r={}){let t=C(r.plugins),n=te(1,{plugins:t,disabledFeatures:r.disabledFeatures});return{t:await ne(n,e),f:n.base.features,m:Array.from(n.base.marked)}}function Fa(e,r={}){let t=C(r.plugins),n=or({plugins:t,features:e.f,markedRefs:e.m});return sr(n,e.t)}function Ba(e,r={}){let t=C(r.plugins),n=kt({plugins:t,markedRefs:e.m});return tr(n,e.t)}
