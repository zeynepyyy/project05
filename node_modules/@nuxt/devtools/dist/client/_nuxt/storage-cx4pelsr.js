import{a4 as ne,a5 as oe,a6 as ae,a7 as P,G as le,r as c,E as x,a8 as se,v as re,I as ue,_ as ie,i as de,n as pe,a9 as T,aa as me}from"#entry";import{_ as ve}from"./nselect-h7b4tp2d.js";import{_ as ce}from"./nlink-cmgg7q58.js";import{_ as _e}from"./filepath-item-f2iy8phl.js";import{p as G,k as M,au as F,M as fe,x as ye,w as ge,q as xe,W as m,u as _,X as l,Z as r,J as u,a2 as s,ac as ke,a3 as R,a5 as U,ab as i,a0 as d,aa as k,a6 as z,av as be,a1 as we,at as Ce,al as Ke,ag as A,F as b,j as Se}from"./vendor/json-editor-vue-ho2zu772.js";import"./vendor/shiki-g7cm1eew.js";import"./vendor/unocss-d7th42z7.js";const Ve={class:"h-[48px] flex items-center justify-between gap1 px-3"},Ne={class:"w-full text-sm"},Ie=["value"],$e=["onClick"],he={key:0,"h-full":"","of-hidden":"",flex:"~ col"},je={border:"b base",class:"h-[49px] flex flex-none items-center justify-between px-4 text-sm"},De={class:"flex items-center gap-4"},Me={key:1},Ue=["onKeyup"],Ae={key:0,op50:""},qe={key:1},Be={"font-bold":""},Le={"text-sm":""},Ee=G({__name:"StorageDetails",async setup(O){let p,y;const w=ne(),C=oe(),K=ae(),S=M(""),g=M(""),a=P("storage:current",""),t=M(),f=P("storage:file:state",""),{data:V}=([p,y]=F(()=>T("storageMounts",()=>c.getStorageMounts())),p=await p,y(),p),{data:N,refresh:q}=([p,y]=F(async()=>T("storageKeys",async()=>a.value?await c.getStorageKeys(a.value):[])),p=await p,y(),p),W=C.hook("storage:key:update",async(n,e)=>{if(!(!a.value||n.split(":")[0]!==a.value)&&(await q(),f.value===n)){if(e==="remove")return K.replace({query:{storage:a.value}});await $(f.value)}});fe(W),ye(a,()=>{q(),f.value=""}),ge(async()=>{if(!f.value){t.value=null;return}$(f.value)}),le("keydown",n=>{n.key==="s"&&(n.ctrlKey||n.metaKey)&&(h(),n.preventDefault())});function I(n){return n.replace(`${a.value}:`,"")}const J=xe(()=>N.value?N.value.filter(n=>n.includes(S.value)):[]);async function $(n){const e=await c.getStorageItem(await x(),n);t.value={key:n,updatedKey:I(n),editingKey:!1,content:e,updatedContent:e}}async function X(){if(!g.value||!a.value)return;const n=`${a.value}:${g.value}`;N.value?.includes(n)||await c.setStorageItem(await x(),n,""),K.replace({query:{storage:a.value,key:n}}),g.value=""}async function h(){t.value&&(await c.setStorageItem(await x(),t.value.key,t.value.updatedContent),await $(t.value.key))}async function Z(){!t.value||!a.value||(await c.removeStorageItem(await x(),t.value.key),t.value=null)}async function H(){if(!t.value||!a.value)return;const n=`${a.value}:${t.value.updatedKey}`,e=await x();await c.setStorageItem(e,n,t.value.updatedContent),await c.removeStorageItem(e,t.value.key),K.replace({query:{storage:a.value,key:n}})}return(n,e)=>{const j=ie,Q=ve,D=re,Y=ue,B=ce,L=pe,E=de,ee=se,te=_e;return _(a)?(l(),m(ee,{key:0,"storage-key":"tab-storage"},{left:r(()=>[s("div",Ve,[d(j,{icon:"carbon-chevron-left","ml--1":"",border:!1,onClick:e[0]||(e[0]=o=>a.value="")}),s("div",Ne,[d(Q,{modelValue:_(a),"onUpdate:modelValue":e[1]||(e[1]=o=>Se(a)?a.value=o:null),n:"primary",icon:"carbon-data-base"},{default:r(()=>[(l(!0),u(b,null,A(_(V),(o,v)=>(l(),u("option",{key:v,value:v},k(v),9,Ie))),128))]),_:1},8,["modelValue"])])]),d(D,{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=o=>S.value=o),icon:"carbon-search",placeholder:"Search...",n:"primary sm",border:"y x-none base! rounded-0",class:"w-full py2 ring-0!"},null,8,["modelValue"]),(l(!0),u(b,null,A(J.value,o=>(l(),u(b,{key:o},[s("button",{block:"","w-full":"",truncate:"",px2:"",py1:"","text-start":"","text-sm":"","font-mono":"",class:z(o===t.value?.key?"text-primary n-bg-active":"text-secondary hover:n-bg-hover"),onClick:v=>f.value=o},k(I(o)),11,$e),e[8]||(e[8]=s("div",{"x-divider":""},null,-1))],64))),128)),d(D,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=o=>g.value=o),icon:"carbon-add",placeholder:"key",n:"sm",border:"t-none x-none base! rounded-0",class:"w-full py2 font-mono ring-0!",onKeyup:U(X,["enter"])},null,8,["modelValue"])]),right:r(()=>[t.value?.key?(l(),u("div",he,[s("div",je,[s("div",De,[t.value.editingKey?(l(),m(D,{key:0,modelValue:t.value.updatedKey,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.updatedKey=o),onKeyup:U(H,["enter"])},null,8,["modelValue"])):(l(),u("code",Me,[i(k(I(t.value.key))+" ",1),d(Y,{icon:"carbon-edit",class:"cursor-pointer op50 hover:op100",onClick:e[5]||(e[5]=o=>t.value.editingKey=!0)})])),t.value.editingKey?R("",!0):(l(),m(j,{key:2,n:"green xs",disabled:t.value.content===t.value.updatedContent,class:z({"border-green":t.value.content!==t.value.updatedContent}),onClick:h},{default:r(()=>[...e[9]||(e[9]=[i(" Save ",-1)])]),_:1},8,["disabled","class"]))]),s("div",null,[d(j,{n:"red xs",onClick:Z},{default:r(()=>[...e[10]||(e[10]=[i(" Delete ",-1)])]),_:1})])]),typeof t.value.content=="object"?(l(),m(_(be),we({key:0,modelValue:t.value.updatedContent,"onUpdate:modelValue":e[6]||(e[6]=o=>t.value.updatedContent=o),class:[[_(w)==="dark"?"jse-theme-dark":"light"],"json-editor-vue h-full of-auto text-sm outline-none"]},n.$attrs,{mode:"text","navigation-bar":!1,indentation:2,"tab-size":2}),null,16,["modelValue","class"])):ke((l(),u("textarea",{key:1,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.updatedContent=o),placeholder:"Item value...",class:"h-full of-auto p-4 text-sm font-mono outline-none",onKeyup:U(Ke(h,["ctrl"]),["enter"])},null,40,Ue)),[[Ce,t.value.updatedContent]])])):(l(),m(E,{key:1},{default:r(()=>[d(L,{px6:"",py4:""},{default:r(()=>[e[12]||(e[12]=i(" Select one key to start.",-1)),e[13]||(e[13]=s("br",null,null,-1)),e[14]||(e[14]=i("Learn more about ",-1)),d(B,{href:"https://nitro.unjs.io/guide/storage",n:"orange",target:"_blank"},{default:r(()=>[...e[11]||(e[11]=[i(" Nitro storage ",-1)])]),_:1})]),_:1})]),_:1}))]),_:1})):(l(),m(E,{key:1},{default:r(()=>[Object.keys(_(V)).length?(l(),u("p",Ae," Select one storage to start: ")):(l(),u("p",qe,[e[16]||(e[16]=i(" No custom storage defined in ",-1)),e[17]||(e[17]=s("code",null,"nitro.storage",-1)),e[18]||(e[18]=i(".",-1)),e[19]||(e[19]=s("br",null,null,-1)),e[20]||(e[20]=i(" Learn more about ",-1)),d(B,{href:"https://nitro.unjs.io/guide/storage",n:"orange",target:"_blank"},{default:r(()=>[...e[15]||(e[15]=[i(" Nitro storage ",-1)])]),_:1})])),(l(!0),u(b,null,A(_(V),(o,v)=>(l(),m(L,{key:v,"min-w-80":"","cursor-pointer":"","p-4":"","text-left":"",hover:"border-green",onClick:Te=>a.value=v},{default:r(()=>[s("span",Be,k(v),1),e[21]||(e[21]=s("br",null,null,-1)),s("span",Le,k(o.driver)+" driver",1),e[22]||(e[22]=s("br",null,null,-1)),o.base?(l(),m(te,{key:0,"text-xs":"",filepath:o.base},null,8,["filepath"])):R("",!0)]),_:2},1032,["onClick"]))),128))]),_:1}))}}}),Pe=Object.assign(Ee,{__name:"StorageDetails"}),Xe=G({__name:"storage",setup(O){return(p,y)=>{const w=Pe,C=me;return l(),m(C,null,{default:r(()=>[d(w)]),_:1})}}});export{Xe as default};
